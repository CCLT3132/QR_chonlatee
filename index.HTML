<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 650px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    h2 {
      color: #667eea;
      text-align: center;
      margin-bottom: 10px;
      font-size: 28px;
    }
    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }
    
    .info-box {
      background: #e3f2fd;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 25px;
      border-left: 4px solid #2196f3;
    }
    .info-box h3 {
      color: #1976d2;
      font-size: 16px;
      margin-bottom: 8px;
    }
    .info-box p {
      color: #555;
      font-size: 13px;
      line-height: 1.6;
    }
    .info-box code {
      background: #fff;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 12px;
      color: #d32f2f;
    }
    
    .warning-box {
      background: #fff3cd;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      border-left: 4px solid #ffc107;
    }
    .warning-box h4 {
      color: #856404;
      margin-bottom: 8px;
    }
    .warning-box ul {
      margin-left: 20px;
      color: #856404;
      font-size: 13px;
    }
    .warning-box li {
      margin-bottom: 5px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
      font-size: 14px;
    }
    .required {
      color: #f44336;
    }
    input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 16px;
      transition: border-color 0.3s;
    }
    input:focus {
      outline: none;
      border-color: #667eea;
    }
    small {
      display: block;
      margin-top: 5px;
      color: #666;
      font-size: 12px;
    }
    button {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
    }
    button:active {
      transform: translateY(0);
    }
    
    #qrSection {
      margin-top: 30px;
      padding: 30px;
      background: #f8f9fa;
      border-radius: 15px;
      text-align: center;
      display: none;
    }
    #qrSection.show {
      display: block;
    }
    #qrcode {
      display: inline-block;
      padding: 20px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .qr-info {
      color: #28a745;
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 15px;
    }
    .download-btn {
      margin-top: 15px;
      padding: 12px 30px;
      background: #28a745;
      width: auto;
      display: inline-block;
    }
    .download-btn:hover {
      background: #218838;
      box-shadow: 0 5px 20px rgba(40, 167, 69, 0.4);
    }
    
    .message {
      padding: 15px;
      border-radius: 10px;
      margin-top: 15px;
      text-align: center;
      font-weight: bold;
    }
    .message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .test-url {
      margin-top: 20px;
      padding: 15px;
      background: #fff3cd;
      border-radius: 10px;
      border: 1px solid #ffc107;
    }
    .test-url h4 {
      color: #856404;
      margin-bottom: 10px;
    }
    .test-url a {
      color: #0066cc;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üì± ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h2>
    <p class="subtitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡πÅ‡∏ö‡∏ö URL - ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</p>
    
    <div class="info-box">
      <h3>üìå ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!)</h3>
      <p>
        <strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1:</strong> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå <code>employee_qr.html</code> ‡∏Ç‡∏∂‡πâ‡∏ô GitHub Pages<br>
        <strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2:</strong> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á "URL ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏Æ‡∏™‡∏ï‡∏¥‡πâ‡∏á"<br>
        <strong>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á URL:</strong> <code>https://yourusername.github.io/your-repo/employee_qr.html</code>
      </p>
    </div>

    <div class="warning-box">
      <h4>üñºÔ∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å Google Drive</h4>
      <ul>
        <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 1:</strong> ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡πÉ‡∏ô Google Drive</li>
        <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 2:</strong> ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤ ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÅ‡∏ä‡∏£‡πå"</li>
        <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 3:</strong> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡πÑ‡∏î‡πâ"</li>
        <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 4:</strong> ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå"</li>
        <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 5:</strong> ‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á "URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û" ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</li>
      </ul>
      <p style="margin-top:10px"><strong>üí° ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô:</strong> Imgur, GitHub, ‡∏´‡∏£‡∏∑‡∏≠ Direct Image URL</p>
    </div>

    <div class="form-group">
      <label>URL ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏Æ‡∏™‡∏ï‡∏¥‡πâ‡∏á <span class="required">*</span></label>
      <input type="url" id="hosting_url" placeholder="https://yourusername.github.io/your-repo/employee_qr.html">
      <small>‚ö†Ô∏è ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå employee_qr.html ‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß</small>
    </div>

    <div class="form-group">
      <label>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô <span class="required">*</span></label>
      <input type="text" id="emp_id" placeholder="EMP001">
    </div>

    <div class="form-group">
      <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="required">*</span></label>
      <input type="text" id="fullname" placeholder="‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ">
    </div>

    <div class="form-group">
      <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
      <input type="text" id="nickname" placeholder="‡∏ä‡∏≤‡∏¢">
    </div>

    <div class="form-group">
      <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô</label>
      <input type="date" id="startdate">
    </div>

    <div class="form-group">
      <label>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô</label>
      <input type="text" id="position" placeholder="‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢">
    </div>

    <div class="form-group">
      <label>‡πÅ‡∏ú‡∏ô‡∏Å</label>
      <input type="text" id="department" placeholder="‡∏ù‡πà‡∏≤‡∏¢‡∏Ç‡∏≤‡∏¢">
    </div>

    <div class="form-group">
      <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
      <input type="tel" id="phone" placeholder="081-234-5678">
    </div>

    <div class="form-group">
      <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
      <input type="email" id="email" placeholder="example@company.com">
    </div>

    <div class="form-group">
      <label>LINE ID</label>
      <input type="text" id="lineid" placeholder="@username">
    </div>

    <div class="form-group">
      <label>URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (Google Drive / Imgur / Direct Link)</label>
      <input type="url" id="photo_url" placeholder="https://drive.google.com/file/d/... ‡∏´‡∏£‡∏∑‡∏≠ https://i.imgur.com/...">
      <small>üí° ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: Google Drive (‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞), Imgur, ‡∏´‡∏£‡∏∑‡∏≠ Direct Image URL</small>
    </div>

    <button onclick="generateQR()">üéØ ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code</button>
    
    <div id="message"></div>
    
    <div id="qrSection">
      <div id="qrcode"></div>
      <div class="qr-info">‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</div>
      <button class="download-btn" onclick="downloadQR()">üíæ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î QR Code</button>
      
      <div class="test-url">
        <h4>üîó ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á QR:</h4>
        <a id="testLink" href="#" target="_blank">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</a>
      </div>
    </div>
  </div>

  <script>
    let currentCanvas = null;

    function convertGoogleDriveLink(url) {
      if (!url) return '';
      
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå Google Drive ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
      if (url.includes('drive.google.com')) {
        // ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 1: https://drive.google.com/file/d/FILE_ID/view
        let match = url.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);
        if (match) {
          return `https://drive.google.com/thumbnail?id=${match[1]}&sz=w200`;
        }
        
        // ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 2: https://drive.google.com/open?id=FILE_ID
        match = url.match(/[?&]id=([a-zA-Z0-9_-]+)/);
        if (match) {
          return `https://drive.google.com/thumbnail?id=${match[1]}&sz=w200`;
        }
        
        // ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 3: ‡∏°‡∏µ‡πÅ‡∏ï‡πà FILE_ID
        match = url.match(/([a-zA-Z0-9_-]{25,})/);
        if (match) {
          return `https://drive.google.com/thumbnail?id=${match[0]}&sz=w200`;
        }
      }
      
      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Google Drive ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ URL ‡πÄ‡∏î‡∏¥‡∏°
      return url;
    }

    function generateQR() {
      const hostingUrl = document.getElementById("hosting_url").value.trim();
      const empId = document.getElementById("emp_id").value.trim();
      const fullname = document.getElementById("fullname").value.trim();
      const nickname = document.getElementById("nickname").value.trim();
      const startdate = document.getElementById("startdate").value;
      const position = document.getElementById("position").value.trim();
      const department = document.getElementById("department").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const email = document.getElementById("email").value.trim();
      const lineid = document.getElementById("lineid").value.trim();
      const photoUrl = document.getElementById("photo_url").value.trim();

      if (!hostingUrl) {
        showMessage("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å URL ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏Æ‡∏™‡∏ï‡∏¥‡πâ‡∏á", "error");
        return;
      }

      if (!empId || !fullname) {
        showMessage("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•", "error");
        return;
      }

      // ‡πÅ‡∏õ‡∏•‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û Google Drive
      const convertedPhotoUrl = convertGoogleDriveLink(photoUrl);

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠
      const data = {
        i: empId,
        n: fullname,
        nn: nickname,
        d: startdate,
        p: position,
        dp: department,
        ph: phone,
        e: email,
        l: lineid,
        img: convertedPhotoUrl
      };

      // ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      const encoded = btoa(encodeURIComponent(JSON.stringify(data)));
      const qrUrl = `${hostingUrl}#${encoded}`;

      // ‡πÅ‡∏™‡∏î‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö
      document.getElementById("testLink").href = qrUrl;
      document.getElementById("testLink").textContent = qrUrl;

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code
      const qrcodeDiv = document.getElementById("qrcode");
      qrcodeDiv.innerHTML = "";
      
      try {
        new QRCode(qrcodeDiv, {
          text: qrUrl,
          width: 300,
          height: 300,
          colorDark: "#000000",
          colorLight: "#ffffff",
          correctLevel: QRCode.CorrectLevel.L
        });
        
        document.getElementById("qrSection").classList.add("show");
        showMessage("QR Code ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‡∏•‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö", "success");
        
        setTimeout(() => {
          currentCanvas = qrcodeDiv.querySelector('canvas');
        }, 100);
        
      } catch (e) {
        showMessage("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + e.message, "error");
      }
    }

    function downloadQR() {
      if (currentCanvas) {
        const empId = document.getElementById("emp_id").value.trim();
        const link = document.createElement('a');
        link.download = `QR_${empId || 'employee'}.png`;
        link.href = currentCanvas.toDataURL();
        link.click();
      }
    }

    function showMessage(text, type) {
      const msgDiv = document.getElementById("message");
      msgDiv.className = `message ${type}`;
      msgDiv.textContent = text;
      setTimeout(() => {
        msgDiv.className = 'message';
        msgDiv.textContent = '';
      }, 5000);
    }
  </script>
</body>
</html>